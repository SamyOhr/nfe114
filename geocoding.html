<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Geocoding</title>
	<link rel="stylesheet" href="https://openlayers.org/en/v6.3.1/css/ol.css" type="text/css">
	<script src="https://openlayers.org/en/v6.3.1/build/ol.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
	<script src="lacarteexo6.js"></script>
	<script>
		function envoyer(){
			// Récupération des valeurs saisies par l'utilisateur
			var rue = document.getElementById('rue').value;
			var ville = document.getElementById('code').value;

			// API issu de https://adresse.data.gouv.fr/api-doc/adresse

			// Création de l'object Ajax
			var req= new XMLHttpRequest();

			// Préparation de requête
			req.open("GET","https://api-adresse.data.gouv.fr/search/?q="+rue+"&postcode="+ville,false);

			// Envois de l'information au serveur
			req.send(null); 

			// Reception et affichage du résultat
			var geocodeObjet = JSON.parse(req.responseText);

			// Filtre pour récuppérer uniquement les valeurs GPS de l'adresse
			var long = geocodeObjet.features[0].geometry.coordinates[0];
			var lat = geocodeObjet.features[0].geometry.coordinates[1];

			// Positionne le POI de départ sur les coordonnées fournies par l'utilisateur
			positionnerPOIDepart(long, lat);

			// Affichage des coordonnées récupérées de l'API
			document.getElementById('result').innerHTML="Long "+long+"</br>Lat "+lat;
		}    
	</script>
</head>
<body>
	<p>Adresse <input id="rue"/></p>
	<p>Code postal <input id="code"/></p>
	<button onclick="envoyer()">Envoyer</button>
	<p id="result"></p>
	<div id="maCarte" style="width:100%; height:500px"></div>
	<script>
		// Affichage de la carte avec le POI de départ positionné sur Paris
		afficherCarteAvecPOIDepart();
	</script>
</body>
</html>

